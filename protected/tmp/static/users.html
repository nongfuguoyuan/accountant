<div class="row">
	
	<aside id="zside-overlay">
        <div id="side-overlay-scroll">
            <div class="side-header side-content">
                <button ng-click="closewin()" class="btn btn-default pull-right" type="button" data-toggle="layout" data-action="side_overlay_close">
                    <i class="fa fa-times"></i>
                </button>
                <span>
                    <span class="font-w600 push-10-l">{{company}}</span>
                    <div class="push-10-l">{{name}}</div>
                </span>
            </div>
            <div class="side-content remove-padding-t">
                <div class="block pull-r-l">
                    <div class="block-header bg-gray-lighter">
                        <!-- <h3 data-permission="record/add" class="block-title text-center">
                        	<button class="btn btn-minw btn-default" ng-click="getRecord($event.target)">历史跟踪记录</button>
                        </h3> -->
                    </div>
                    <div class="block-content z-content">
                    	<div ng-if="opens.length > 0" class="push-10">
	                    	<h6 class="push-10">已开通服务</h6>
	                    	<ul class="list">
	                    		<li ng-repeat="p in opens" class="clearfix push-5">
	                    			<span class="label label-primary">{{ p.name }}</span>
	                    			<div ng-if="p.progress_value != null" class="push-10-t">
		                    			<div class="progress active">
		                                    <div class="progress-bar progress-bar-success progress-bar-striped" role="progressbar" aria-valuenow="{{p.progress_value}}" aria-valuemin="0" aria-valuemax="100" style="width: {{p.progress_value}}%">{{p.progress}}</div>
		                                </div>
	                                </div>
	                    		</li>
	                    	</ul>
                    	</div>
                    	<div ng-if="accounting.open">
	                    	<h6 class="push-10">代理记账</h6>
	                    	<div>
	                    		<p class="push-10">
	                    			服务截至日期：{{ accounting.deadline }}
	                    		</p>
	                    		<p>
	                    			状态：<span class="badge badge-danger">{{ accounting.status }}</span>
	                    		</p>
	                    	</div>
                    	</div>
                    	<div ng-if="tax.open">
	                    	<h6 class="push-10">财务报表</h6>
	                    	<div>
	                    		<p>
	                    			最近缴税月份：{{ tax.deadline }}
	                    		</p>
	                    	</div>
                    	</div>
                    </div>
                </div>
            </div>
            <div class="toolbar">
            	<div class="push-10">
	            	<!-- <button data-permission="guest/save" class="btn btn-default" data-toggle="modal" data-target="#add-new-user">添加客户</button> -->
	            	<button ng-click="vanEditGuest()" class="btn btn-default" data-toggle="modal" data-target="#edit-guest">编辑客户</button>
	            	<button data-permission="guest/delete" class="btn btn-default" ng-click="deleteGuest()">删除客户</button>
            	</div>
            	<div>
	            	<button class="btn btn-default" ng-click="initBusiness()" data-toggle="modal" data-target="#add-business">工商业务</button>
	            	<button ng-click="vanAddAccounting()" data-permission="accounting/save" class="btn btn-default" data-toggle="modal" data-target="#add-account">代理记账</button>
            	</div>
            </div>
        </div>
    </aside>
	
	<div class="col-sm-12">
		<div class="clearfix push-10">
		    <div class="pull-left">
		    	<input ng-keyup="selectCom($event.target,$event)" type="text" placeholder="公司/电话/姓名" class="form-control" />
		    </div>
		    <div ng-if="level>1">
			    <div class="pull-left push-10-l input-xm">
			    	<a data-toggle="modal" data-target="#show-tree">
			    		<input type="text" class="form-control" placeholder="部门" ng-model="select_department"/>
			    	</a>
			    </div>
		    </div>
			<div class="push-10-l pull-left">
				<select class="form-control" ng-change="changeStatus()" ng-model="status" ng-init="status=1">
					<option value="0">潜在客户</option>
					<option value="1">成交客户</option>
					<option value="2">流失客户</option>
				</select>
			</div>
			<div class="pull-left remove-padding-l push-10-l rel call-date-control col-lg-2">
				<div class="input-group">
                    <input class="form-control" type="text" placeholder="日期" ng-model="whole"/>
                    <span class="input-group-btn">
                        <button ng-click="clearDate()" class="btn btn-default" type="button"><i class="fa fa-close"></i></button>
                    </span>
                </div>
				<div class="date-select">
					<div class="date-year">
						<ul>
							<li ng-click="initYear($event.target)">2014</li>
							<li ng-click="initYear($event.target)">2015</li>
							<li ng-click="initYear($event.target)">2016</li>
						</ul>
					</div>
					<div class="date-month">
						<ul>
							<li><a ng-click="initMonth($event.target)">1</a></li>
							<li><a ng-click="initMonth($event.target)">2</a></li>
							<li><a ng-click="initMonth($event.target)">3</a></li>
							<li><a ng-click="initMonth($event.target)">4</a></li>
							<li><a ng-click="initMonth($event.target)">5</a></li>
							<li><a ng-click="initMonth($event.target)">6</a></li>
							<li><a ng-click="initMonth($event.target)">7</a></li>
							<li><a ng-click="initMonth($event.target)">8</a></li>
							<li><a ng-click="initMonth($event.target)">9</a></li>
							<li><a ng-click="initMonth($event.target)">10</a></li>
							<li><a ng-click="initMonth($event.target)">11</a></li>
							<li><a ng-click="initMonth($event.target)">12</a></li>
						</ul>
					</div>
				</div>
			</div>
		    <a data-permission="guest/save" ng-click="vanAddGuest()" class="pull-right btn btn-minw btn-square btn-info" data-toggle="modal" data-target="#add-new-user">新建客户</a>
	    </div>
		<table class="table table-bordered table-striped js-dataTable-full dataTable no-footer">
			<thead class="bg-gray-light">
				<th>公司</th>
				<th>姓名</th>
				<th>状态</th>
				<th>区</th>
				<th>手机</th>
				<th>跟进客服</th>
				<th>开通服务</th>
				<th>跟进记录</th>
				<th>录入日期</th>
			</thead>
			<tbody>
				<tr ng-repeat="u in guests">
					<td>
						<a ng-click="initRight(u)">{{ u.company }}</a>
					</td>
					<td>
						<a ng-click="initRight(u)">{{ u.name }}</a>
					</td>
					<td ng-switch="u.status">
						<span ng-switch-when="0">
						潜在客户
						</span>
						<span ng-switch-when="1">
						成交客户
						</span>
						<span ng-switch-when="2">
						流失客户
						</span>
					</td>
					<td>{{ u.a_name }}</td>
					<td>{{ u.phone }}</td>
					<td>{{ u.e_name }}</td>
					<td>
						<span ng-repeat="p in u.opens">
							<span class="label label-success">{{p}}</span>
						</span>
					</td>
					<td>
						<a data-toggle="modal" data-target="#add-guest-record" ng-click="getRecord(u.guest_id,$event)" data-count="{{u.record_count}}">
							{{ u.record_count == null ? 0 : u.record_count }}
						</a>
						次
					</td>
					<td>{{ u.create_time }}</td>
				</tr>
			</tbody>
		</table>
		<div class="dataTables_paginate paging_simple_numbers">
			<ul class="pagination pull-right">
				<!--
				<li class="paginate_button previous disabled" aria-controls="DataTables_Table_0" tabindex="0" id="DataTables_Table_0_previous"><a href="#"><i class="fa fa-angle-left"></i></a></li>
				<li class="paginate_button active" aria-controls="DataTables_Table_0" tabindex="0"><a href="#">1</a></li>
				<li class="paginate_button " aria-controls="DataTables_Table_0" tabindex="0"><a href="#">2</a></li>
				<li class="paginate_button " aria-controls="DataTables_Table_0" tabindex="0"><a href="#">3</a></li>
				<li class="paginate_button " aria-controls="DataTables_Table_0" tabindex="0"><a href="#">4</a></li>
				<li class="paginate_button next" aria-controls="DataTables_Table_0" tabindex="0" id="DataTables_Table_0_next"><a href="#"><i class="fa fa-angle-right"></i></a></li>
				-->
				<li class="paginate_button" ng-repeat="p in pagination" ng-repeat="current">
					<a href="javascript:;" ng-class="{true: 'active', false: 'nothing'}[current==p]" data-current="{{p}}" ng-click="getPage($event.target)">{{ p }}</a>
				</li>
			</ul>
		</div>
	</div>
	<!-- 员工菜单 begin -->
    <div class="modal in" id="show-tree" tabindex="-1" role="dialog" aria-hidden="false" style="display: none;">
	    <div class="modal-dialog modal-sm">
	        <div class="modal-content">
	            <div class="block block-themed block-transparent remove-margin-b">
	                <div class="block-header bg-primary-dark">
	                    <ul class="block-options">
	                        <li>
	                            <button data-dismiss="modal" type="button"><i class="si si-close"></i></button>
	                        </li>
	                    </ul>
	                    <h3 class="block-title">请选择</h3>
	                </div>
	                <div class="block-content clearfix">
	                	<div id="tree-show" class="pull-left menu-tree">
						</div>
	                </div>
	            </div>
	            <div class="modal-footer">
	                <button class="btn btn-sm btn-default" type="button" data-dismiss="modal"><i class="fa fa-close"></i></button>
	                <button ng-click="reload($event.target)" class="btn btn-sm btn-primary" type="button">确定</button>
	            </div>
	        </div>
	    </div>
	</div>
    <!-- 员工菜单 end   -->

	<!-- 新建客户 begin-->
	<div class="modal in" id="add-new-user" tabindex="-1" role="dialog" aria-hidden="false" style="display: none;">
	    <div class="modal-dialog modal-mx">
	        <div class="modal-content">
	            <div class="block block-themed block-transparent remove-margin-b">
	                <div class="block-header bg-primary-dark">
	                    <ul class="block-options">
	                        <li>
	                            <button data-dismiss="modal" type="button"><i class="si si-close"></i></button>
	                        </li>
	                    </ul>
	                    <h3 class="block-title">添加客户</h3>
	                </div>
	                <div class="block-content">
	                	<form class="form-horizontal" onsubmit="return false;">
	                		<div class="form-group">
	                            <label class="col-lg-3 control-label">公司</label>
	                            <div class="col-lg-7">
	                                <input class="form-control" type="text" ng-model="add_company">
	                            </div>
	                        </div>
	                        <div class="form-group">
	                            <label class="col-lg-3 control-label">姓名</label>
	                            <div class="col-lg-7">
	                                <input class="form-control" type="text" ng-model="add_name">
	                            </div>
	                        </div>
	                        <div class="form-group">
	                            <label class="col-lg-3 control-label">手机</label>
	                            <div class="col-lg-7">
	                                <input class="form-control" type="text" ng-model="add_phone">
	                            </div>
	                        </div>
	                        <div class="form-group">
	                            <label class="col-lg-3 control-label">座机</label>
	                            <div class="col-lg-7">
	                                <input class="form-control" type="text" ng-model="add_tel">
	                            </div>
	                        </div>
	                        <div class="form-group">
	                            <label class="col-lg-3 control-label">区</label>
	                            <div class="col-lg-7">
	                                <select class="form-control" ng-model="add_area_id">
	                                	<option ng-repeat='area in areas' value="{{area.area_id}}">{{area.name}}</option>
	                                </select>
	                            </div>
	                        </div>
	                        <div class="form-group">
	                            <label class="col-lg-3 control-label">详细地址</label>
	                            <div class="col-lg-7">
	                                <input class="form-control" type="text" ng-model="add_address">
	                            </div>
	                        </div>
	                        <div class="form-group">
	                            <label class="col-lg-3 control-label">客户来源</label>
	                            <div class="col-lg-7">
	                                <select class="form-control" ng-model="add_resource_id">
	                                	<option ng-repeat="r in resource" value="{{ r.resource_id }}">{{ r.description }}</option>
	                                </select>
	                            </div>
	                        </div>
	                        <div class="form-group">
	                            <label class="col-lg-3 control-label">职务</label>
	                            <div class="col-lg-7">
	                                <input class="form-control" type="text" ng-model="add_job">
	                            </div>
	                        </div>
	                        <div class="form-group">
	                            <label class="col-lg-3 control-label">客户状态</label>
	                            <div class="col-lg-7">
	                                <select class="form-control" ng-model="add_status" ng-init="add_status=0">
	                                	<option value="0">潜在客户</option>
	                                	<option value="1">成交客户</option>
	                                	<option value="2">已流失</option>
	                                </select>
	                            </div>
	                        </div>
	                    </form>
	                </div>
	            </div>
	            <div class="modal-footer">
	                <button class="btn btn-sm btn-default" type="button" data-dismiss="modal"><i class="fa fa-close"></i></button>
	                <button ng-click="addGuest($event.target)" class="btn btn-sm btn-primary" type="button">添加</button>
	            </div>
	        </div>
	    </div>
	</div>
	<!-- 新建客户 end-->
	<!-- 查询/添加 跟进记录 begin-->
	<div class="modal in" id="add-guest-record" tabindex="-1" role="dialog" aria-hidden="false" style="display: none;">
	    <div class="modal-dialog modal-mx">
	        <div class="modal-content">
	            <div class="block block-themed block-transparent remove-margin-b">
	                <div class="block-header bg-primary-dark">
	                    <ul class="block-options">
	                        <li>
	                            <button data-dismiss="modal" type="button"><i class="si si-close"></i></button>
	                        </li>
	                    </ul>
	                    <h3 class="block-title">详细追踪纪录</h3>
	                </div>
	                <div class="block-content">
						<ul class="list list-activity">
                    		<li ng-repeat="f in follow_record" class="record-list">
	                            <div class="font-w600">
	                            	第{{ follow_record.length - $index }}次
									<span class="push-5-l">
			                            <i data-permission="record/udpate" class="fa fa-pencil" ng-click="vanEditRecord(f)" data-toggle="modal" data-target="#edit-guest-record"></i>
			                            <i data-permission="record/delete" class="fa fa-times push-2-t cursor" ng-click="deleteRecord(f.record_id,$event.target)"></i>
		                            </span>
	                            </div>
	                            <div><a href="javascript:void(0)">{{ f.create_time }}</a></div>
	                            <div><small class="text-muted">{{ f.content }}</small></div>
                            </li>
                        </ul>
	                	<form class="form-horizontal" onsubmit="return false;">
	                		<div class="form-group">
	                           <textarea placeholder="详细记录" class="form-control" ng-model="add_record"></textarea>
	                        </div>
	                    </form>
	                </div>
	            </div>
	            <div class="modal-footer">
	                <button class="btn btn-sm btn-default" type="button" data-dismiss="modal"><i class="fa fa-close"></i></button>
	                <button ng-click="addRecord($event.target)" class="btn btn-sm btn-primary" type="button">添加</button>
	            </div>
	        </div>
	    </div>
	</div>
	<!-- 查询/添加 跟进记录 end-->
	<!-- 编辑 跟进记录 begin-->
	<div class="modal in bs" id="edit-guest-record" tabindex="-1" role="dialog" aria-hidden="false" style="display: none">
	    <div class="modal-dialog modal-lg">
	        <div class="modal-content">
	            <div class="block block-themed block-transparent remove-margin-b">
	                <div class="block-header bg-primary-dark">
	                    <ul class="block-options">
	                        <li>
	                            <button data-dismiss="modal" type="button"><i class="si si-close"></i></button>
	                        </li>
	                    </ul>
	                    <h3 class="block-title">编辑追踪纪录</h3>
	                </div>
	                <div class="block-content">
	                	<form class="form-horizontal" onsubmit="return false;">
	                		<div class="form-group">
	                           <textarea placeholder="详细记录" class="form-control" ng-model="edit_record"></textarea>
	                        </div>
	                    </form>
	                </div>
	            </div>
	            <div class="modal-footer">
	                <button class="btn btn-sm btn-default" type="button" data-dismiss="modal"><i class="fa fa-close"></i></button>
	                <button ng-click="editRecord($event.target)" class="btn btn-sm btn-primary" type="button">更新</button>
	            </div>
	        </div>
	    </div>
	</div>
	<!-- 编辑 跟进记录 end-->
	<!-- 编辑用户 begin -->
    <div class="modal in" id="edit-guest" tabindex="-1" role="dialog" aria-hidden="false" style="display: none;">
	    <div class="modal-dialog modal-mx">
	        <div class="modal-content">
	            <div class="block block-themed block-transparent remove-margin-b">
	                <div class="block-header bg-primary-dark">
	                    <ul class="block-options">
	                        <li>
	                            <button data-dismiss="modal" type="button"><i class="si si-close"></i></button>
	                        </li>
	                    </ul>
	                    <h3 class="block-title">编辑用户</h3>
	                </div>
	                <div class="block-content">
	                	<form class="form-horizontal" onsubmit="return false;">
		                	<div class="form-group">
	                            <label class="col-lg-3 control-label">公司</label>
	                            <div class="col-lg-7">
	                                <input class="form-control" type="text" ng-model="edit_company">
	                            </div>
	                        </div>
	                        <div class="form-group">
	                            <label class="col-lg-3 control-label">姓名</label>
	                            <div class="col-lg-7">
	                                <input class="form-control" type="text" ng-model="edit_name">
	                            </div>
	                        </div>
	                        <div class="form-group">
	                            <label class="col-lg-3 control-label">手机</label>
	                            <div class="col-lg-7">
	                                <input class="form-control" type="text" ng-model="edit_phone">
	                            </div>
	                        </div>
	                        <div class="form-group">
	                            <label class="col-lg-3 control-label">座机</label>
	                            <div class="col-lg-7">
	                                <input class="form-control" type="text" ng-model="edit_tel">
	                            </div>
	                        </div>
	                        <div class="form-group">
	                            <label class="col-lg-3 control-label">区</label>
	                            <div class="col-lg-7">
	                                <select class="form-control" ng-model="edit_area_id">
	                                	<option ng-repeat='area in areas' value="{{area.area_id}}">{{area.name}}</option>
	                                </select>
	                            </div>
	                        </div>
	                        <div class="form-group">
	                            <label class="col-lg-3 control-label">详细地址</label>
	                            <div class="col-lg-7">
	                                <input class="form-control" type="text" ng-model="edit_address">
	                            </div>
	                        </div>
	                        <div class="form-group">
	                            <label class="col-lg-3 control-label">状态</label>
	                            <div class="col-lg-7">
	                                <select class="form-control" ng-model="edit_status">
	                                	<option value="0">潜在客户</option>
	                                	<option value="1">成交客户</option>
	                                	<option value="2">已流失</option>
	                                </select>
	                            </div>
	                        </div>
                        </form>
	                </div>
	            </div>
	            <div class="modal-footer">
	                <button class="btn btn-sm btn-default" type="button" data-dismiss="modal"><i class="fa fa-close"></i></button>
	                <button ng-click="editGuest($event.target)" class="btn btn-sm btn-primary" type="button"><i class="fa fa-check"></i>更新</button>
	            </div>
	        </div>
	    </div>
	</div>
    <!-- 编辑用户 end -->
    <!-- 添加工商 begin -->
    <div class="modal in" id="add-business" tabindex="-1" role="dialog" aria-hidden="false" style="display: none;">
	    <div class="modal-dialog modal-sm">
	        <div class="modal-content">
	            <div class="block block-themed block-transparent remove-margin-b">
	                <div class="block-header bg-primary-dark">
	                    <ul class="block-options">
	                        <li>
	                            <button data-dismiss="modal" type="button"><i class="si si-close"></i></button>
	                        </li>
	                    </ul>
	                    <h3 class="block-title">添加工商</h3>
	                </div>
	                <div class="block-content">
	                	<form class="form-horizontal" onsubmit="return false;">
	                		<div class="form-group" style="padding:0 10px">
	                		   <label class="control-label">业务类型</label>
	                           <select class="form-control" ng-model="process_group_id">
	                           		<option ng-repeat="p in process_group" value="{{ p.process_group_id }}">{{ p.name }}</option>
	                           </select>
	                           <label class="control-label">对接会计</label>
	                           <div class="row">
		                           <!-- <div class="col-lg-6">
			                           <select class="form-control" ng-model="department_id" ng-change="requestEmployee()">
			                           		<option ng-repeat="d in department" value="{{ d.department_id }}">{{ d.name }}</option>
			                           </select>
			                       </div> -->
			                       <div class="col-lg-12">
			                           <select class="form-control" ng-model="employee_id">
			                           		<option ng-repeat="e in employee" value="{{ e.employee_id }}">{{ e.name }}</option>
			                           </select>
			                       </div>
		                       </div>
	                           <label class="control-label">应收款</label>
	                           <input class="form-control" ng-model="should_fee" />
	                           <label class="control-label">已收款</label>
	                           <input class="form-control" ng-model="have_fee" />
	                        </div>
	                    </form>
	                </div>
	            </div>
	            <div class="modal-footer">
	                <button class="btn btn-sm btn-default" type="button" data-dismiss="modal"><i class="fa fa-close"></i></button>
	                <button ng-click="addBusiness($event.target)" class="btn btn-sm btn-primary" type="button"><i class="fa fa-check"></i>添加</button>
	            </div>
	        </div>
	    </div>
	</div>
    <!-- 添加工商 end   -->
    <!-- 添加代理记账 begin -->
    <div class="modal in" id="add-account" tabindex="-1" role="dialog" aria-hidden="false" style="display: none;">
	    <div class="modal-dialog modal-sm">
	        <div class="modal-content">
	            <div class="block block-themed block-transparent remove-margin-b">
	                <div class="block-header bg-primary-dark">
	                    <ul class="block-options">
	                        <li>
	                            <button data-dismiss="modal" type="button"><i class="si si-close"></i></button>
	                        </li>
	                    </ul>
	                    <h3 class="block-title">添加代理记账</h3>
	                </div>
	                <div class="block-content">
	                	<form class="form-horizontal" onsubmit="return false;">
	                		<div class="form-group">
	                			<label>负责人</label>
	                           <div class="row">
		                           <!-- <div class="col-lg-6">
			                           <select class="form-control" ng-model="department_id" ng-change="requestEmployee()">
			                           		<option ng-repeat="d in department" value="{{ d.department_id }}">{{ d.name }}</option>
			                           </select>
			                       </div> -->
			                       <div class="col-lg-12">
			                           <select class="form-control" ng-model="accounting_employee_id">
			                           		<option ng-repeat="e in employee" value="{{ e.employee_id }}">{{ e.name }}</option>
			                           </select>
			                       </div>
		                       </div>
	                        </div>
	                    </form>
	                </div>
	            </div>
	            <div class="modal-footer">
	                <button class="btn btn-sm btn-default" type="button" data-dismiss="modal"><i class="fa fa-close"></i></button>
	                <button ng-click="addAccounting($event.target)" class="btn btn-sm btn-primary" type="button">添加</button>
	            </div>
	        </div>
	    </div>
	</div>
    <!-- 添加代理记账 end   -->
</div>

